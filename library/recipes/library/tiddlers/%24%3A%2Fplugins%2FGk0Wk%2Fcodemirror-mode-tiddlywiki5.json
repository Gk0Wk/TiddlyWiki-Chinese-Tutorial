{"version":"0.0.5","type":"application/json","title":"$:/plugins/Gk0Wk/codemirror-mode-tiddlywiki5","plugin-type":"plugin","parent-plugin":"$:/plugins/tiddlywiki/codemirror","name":"CodeMirror Mode TiddlyWiki5","list":"readme","description":"TiddlyWiki5 highlighting mode for CodeMirror","dependents":"$:/plugins/tiddlywiki/codemirror-autocomplete","text":"{\"tiddlers\":{\"$:/plugins/tiddlywiki/codemirror/mode/tiddlywiki5/tiddlywiki5.js\":{\"text\":\"!function(e){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?e(require(\\\"../../lib/codemirror\\\")):\\\"function\\\"==typeof define&&define.amd?define([\\\"../../lib/codemirror\\\"],e):e(CodeMirror)}(function(T){\\\"use strict\\\";T.defineMode(\\\"tiddlywiki5\\\",function(n,d){var c={rainbow:[\\\"keyword\\\",\\\"variable-2\\\",\\\"variable-3\\\"]},o={changecount:!0,colour:!0,\\\"colour-picker\\\":!0,contrastcolour:!0,\\\"copy-to-clipboard\\\":!0,csvtiddlers:!0,datauri:!0,dumpvariables:!0,\\\"image-picker\\\":!0,jsontiddler:!0,jsontiddlers:!0,lingo:!0,\\\"list-links\\\":!0,\\\"list-links-draggable\\\":!0,\\\"list-tagged-draggable\\\":!0,\\\"list-thumbnails\\\":!0,makedatauri:!0,now:!0,qualify:!0,resolvepath:!0,\\\"box-shadow\\\":!0,filter:!0,transition:!0,\\\"background-linear-gradient\\\":!0,\\\"transform-origin\\\":!0,toc:!0,\\\"toc-expandable\\\":!0,\\\"toc-selective-expandable\\\":!0,\\\"toc-tabbed-internal-nav\\\":!0,\\\"toc-tabbed-external-nav\\\":!0,tabs:!0,tag:!0,\\\"tag-picker\\\":!0,\\\"tag-pill\\\":!0,thumbnail:!0,timeline:!0,tree:!0,unusedtitle:!0,version:!0};function u(e){!T.findModeByName||(t=T.findModeByName(e))&&(e=t.mime||t.mimes[0]);var t=T.getMode(n,e);return\\\"null\\\"==t.name?null:t}d.fencedCodeBlockHighlighting===undefined&&(d.fencedCodeBlockHighlighting=!0),d.fencedCodeBlockDefaultMode===undefined&&(d.fencedCodeBlockDefaultMode=\\\"text/plain\\\");var f=/^\\\\-\\\\-\\\\-+$/,k=/^<<</,s=/^```[ \\\\t]*([\\\\w\\\\/+#-]*)[^\\\\n`]*$/,r=/^```$/;function m(e,t,n){return(t.tokenize=n)(e,t)}function i(e){e.line++,e.listLevel=0,e.boldLine=!1}function b(e,t){var n=e.sol(),o=function(e,t,n){var o=t.peek();if(e&&/[<\\\\/\\\\*{}\\\\-`]/.test(o)){if(t.match(k))return function(e,t){var n=1;for(;e.match(k);)n++;t.quoteLevel==n?t.quoteLevel--:t.quoteLevel<n?(t.quoteHead=!0,t.quoteLevel=n,t.tokenize=function(e,t){return t.quoteHead=!1,t.tokenize=b,e.sol()?null:(e.skipToEnd(),\\\"tag\\\")}):t.quoteLevel=n-1;return\\\"quote line-cm-quote-line\\\"}(t,n);if(t.match(f))return\\\"hr\\\";var r=null;if(r=t.match(s,!1))return function(e,o,r){return o.tokenize=function(e,t){t.tokenize=b;var n=d.fencedCodeBlockHighlighting&&u(r[1]||d.fencedCodeBlockDefaultMode);return t.codeBlockModeState=n?{mode:n,state:T.startState(n),start:o.line}:\\\"unknown\\\",r[1]?(e.skipToEnd(),\\\"tag\\\"):null},e.match(\\\"```\\\"),\\\"comment\\\"}(t,n,r)}r=null;if(e&&(r=t.match(/^\\\\s*([\\\\/\\\\*!#;:>|])/))){if(\\\"!\\\"===(o=r[1])){for(var i=1;t.eat(\\\"!\\\");)i++;return t.skipToEnd(),\\\"header h\\\"+i}if(/[\\\\*#;:]/.test(o)){for(var a=1,l=o;o=t.eat(/[\\\\*#;:]/);)a++,l=o;return n.boldLine=\\\";\\\"===l,n.listLevel=a,\\\"list \\\"+c.rainbow[a%c.rainbow.length]+(\\\";\\\"===l?\\\" strong\\\":\\\"\\\")}if(\\\">\\\"===o)return t.eatWhile(\\\">\\\"),\\\"quote\\\";if(\\\"|\\\"===o)return\\\"header\\\"}if(t.next(),/[hf]/i.test(o)&&/[ti]/i.test(t.peek())&&t.match(/\\\\b(ttps?|tp|ile):\\\\/\\\\/[\\\\-A-Z0-9+&@#\\\\/%?=~_|$!:,.;]*[A-Z0-9+&@#\\\\/%=~_|$]/i,!0))return\\\"externallink link\\\";if(\\\"$\\\"==o&&t.match(\\\"$\\\",!1)&&!t.match(\\\"$$\\\",!1))return t.next(),function(e){e.tokenize=b;var t=d.fencedCodeBlockHighlighting&&u(\\\"text/x-latex\\\");return e.LaTeXModeState=t?{mode:t,state:T.startState(t),start:e.line}:\\\"unknown\\\",\\\"comment\\\"}(n);if(\\\"`\\\"==o)return m(t,n,p);if(\\\"/\\\"==o&&t.eat(\\\"/\\\"))return m(t,n,v);if(\\\"{\\\"==o&&t.eat(\\\"{\\\"))return m(t,n,S);if(\\\"[\\\"==o&&t.eat(\\\"[\\\"))return m(t,n,g);if(\\\"_\\\"==o&&t.eat(\\\"_\\\"))return m(t,n,h);if(\\\"^\\\"==o&&t.eat(\\\"^\\\"))return m(t,n,B);if(\\\",\\\"==o&&t.eat(\\\",\\\"))return m(t,n,L);if(\\\"~\\\"==o&&t.eat(\\\"~\\\"))return m(t,n,x);return\\\"'\\\"==o&&t.eat(\\\"'\\\")?m(t,n,M):\\\"<\\\"==o&&t.eat(\\\"<\\\")?m(t,n,y):null}(n,e,t);return null==o&&(o=\\\"\\\"),0<t.quoteLevel&&n&&(o+=\\\" line-cm-quote-line quote-\\\"+t.quoteLevel),null!=t.codeBlockModeState&&(o+=\\\" comment\\\"),0<t.listLevel&&(o+=\\\" list \\\"+c.rainbow[t.listLevel%c.rainbow.length]),t.boldLine&&(o+=\\\" strong\\\"),o.trim()}function M(e,t){for(var n,o=!1;n=e.next();){if(\\\"'\\\"==n&&o){t.tokenize=b;break}o=\\\"'\\\"==n}return\\\"strong\\\"}function p(e,t){for(var n;n=e.next();)if(\\\"`\\\"==n){t.tokenize=b;break}return\\\"comment\\\"}function v(e,t){for(var n,o=!1;n=e.next();){if(\\\"/\\\"==n&&o){t.tokenize=b;break}o=\\\"/\\\"==n}return\\\"em\\\"}function S(e,t){for(var n,o=!1;n=e.next();){if(\\\"}\\\"==n&&o){t.tokenize=b;break}o=\\\"}\\\"==n}return\\\"builtin\\\"}function g(e,t){if(\\\"[[\\\"==e.current())return t.pastDivider=!1,\\\"link\\\";if(\\\"]\\\"==e.peek()&&(e.next(),\\\"]\\\"==e.next()))return t.tokenize=b,\\\"link\\\";for(var n,o=t.pastDivider;n=e.peek();){if(!o&&\\\"|\\\"==n)return e.next(),t.pastDivider=!0,\\\"internallink link\\\";if(\\\"]\\\"==n&&\\\"]\\\"==e.peek())return\\\"internallink link\\\";if(n=e.next(),/[hf]/i.test(n)&&/[ti]/i.test(e.peek())&&e.match(/\\\\b(ttps?|tp|ile):\\\\/\\\\/[\\\\-A-Z0-9+&@#\\\\/%?=~_|$!:,.;]*[A-Z0-9+&@#\\\\/%=~_|$]/i,!0))return\\\"externallink link\\\";e.eatWhile(/[^|\\\\]]/)}return null}function h(e,t){for(var n,o=!1;n=e.next();){if(\\\"_\\\"==n&&o){t.tokenize=b;break}o=\\\"_\\\"==n}return\\\"underlined\\\"}function L(e,t){for(var n,o=!1;n=e.next();){if(\\\",\\\"==n&&o){t.tokenize=b;break}o=\\\",\\\"==n}return\\\"string subscript\\\"}function B(e,t){for(var n,o=!1;n=e.next();){if(\\\"^\\\"==n&&o){t.tokenize=b;break}o=\\\"^\\\"==n}return\\\"string superscript\\\"}function x(e,t){for(var n,o=!1;n=e.next();){if(\\\"~\\\"==n&&o){t.tokenize=b;break}o=\\\"~\\\"==n}return\\\"strikethrough\\\"}function y(e,t){if(\\\"<<\\\"==e.current())return\\\"macro\\\";var n=e.next();return n?\\\">\\\"==n&&\\\">\\\"==e.peek()?(e.next(),t.tokenize=b,\\\"macro\\\"):(e.eatWhile(/[\\\\w\\\\$_]/),o.propertyIsEnumerable(e.current())?\\\"keyword\\\":\\\"macro\\\"):(t.tokenize=b,null)}var t={blankLine:function(e){return i(e),\\\"\\\"},closeBrackets:\\\"()[]{}''\\\\\\\"\\\\\\\"``\\\",startState:function(){return{tokenize:b,curStream:null,line:0,quoteLevel:0,quoteHead:!1,listLevel:0,boldLine:!1,codeBlockModeState:null,LaTeXModeState:null}},copyState:function(e){var t,n={};for(t in e)n[t]=e[t];e.codeBlockModeState&&\\\"object\\\"==typeof e.codeBlockModeState&&(n.codeBlockModeState={mode:e.codeBlockModeState.mode,state:T.copyState(e.codeBlockModeState.mode,e.codeBlockModeState.state),start:e.start}),e.LaTeXModeState&&(n.LaTeXModeState={mode:e.LaTeXModeState.mode,state:T.copyState(e.LaTeXModeState.mode,e.LaTeXModeState.state),start:e.start})},token:function(e,t){return e!=t.curStream&&(i(t),t.curStream=e),null!=t.codeBlockModeState?e.match(r)?(t.codeBlockModeState=null,\\\"comment\\\"):\\\"string\\\"==typeof t.codeBlockModeState?(e.skipToEnd(),\\\"comment line-background-cm-code-block-line\\\"):t.codeBlockModeState.mode.token(e,t.codeBlockModeState.state)+\\\" line-background-cm-code-block-line\\\":null!=t.LaTeXModeState?e.match(\\\"$$\\\")?(t.LaTeXModeState=null,\\\"comment\\\"):\\\"string\\\"==typeof t.LaTeXModeState?(e.skipToEnd(),\\\"comment latex\\\"):t.LaTeXModeState.mode.token(e,t.LaTeXModeState.state)+\\\" latex\\\":e.match(/^\\\\s+$/,!0)||e.match(/\\\\s+$/,!0)?null:t.tokenize(e,t)},innerMode:function(e){return null!=e.codeBlockModeState&&\\\"object\\\"==typeof e.codeBlockModeState?e.codeBlockModeState:null!=e.LaTeXModeState&&\\\"object\\\"==typeof e.LaTeXModeState?e.LaTeXModeState:{state:e,mode:t}},indent:function(e,t,n){return null!=e.codeBlockModeState&&\\\"object\\\"==typeof e.codeBlockModeState&&\\\"function\\\"==typeof e.codeBlockModeState.mode.indent?e.codeBlockModeState.mode.indent(e.codeBlockModeState.state,t,n):T.Pass}};return t}),T.defineMIME(\\\"text/vnd.tiddlywiki\\\",\\\"tiddlywiki5\\\"),T.defineMIME(\\\"\\\",\\\"tiddlywiki5\\\")});\",\"title\":\"$:/plugins/tiddlywiki/codemirror/mode/tiddlywiki5/tiddlywiki5.js\",\"module-type\":\"codemirror\",\"type\":\"application/javascript\"},\"$:/plugins/Gk0Wk/codemirror-tiddlywiki5/style.css\":{\"text\":\".CodeMirror-hints{z-index:800!important}span.cm-underlined{text-decoration-line:underline}span.cm-superscript{vertical-align:super;font-size:.7em;line-height:.1em}span.cm-subscript{font-size:.7em;line-height:.5}pre.cm-quote-line{padding-left:.4em!important;border-left:#444 solid .2em!important}.cm-code-block-line,.latex{background:rgba(0,0,0,.2)}span.cm-h1{font-weight:700;font-size:1.383em;line-height:1.802em}span.cm-h2{font-weight:600;font-size:1.296em;line-height:1.602em}span.cm-h3{font-weight:500;font-size:1.215em;line-height:1.424em}span.cm-h4{font-weight:400;font-size:1.138em;line-height:1.266em}span.cm-h5{font-weight:400;font-size:1.067em;line-height:1.125em}span.cm-h6{font-weight:400}span.cm-link{font-weight:600;cursor:pointer}span.cm-internallink{text-decoration:none}\",\"type\":\"text/css\",\"title\":\"$:/plugins/Gk0Wk/codemirror-tiddlywiki5/style.css\",\"tags\":\"$:/tags/Stylesheet\"},\"$:/plugins/tiddlywiki/codemirror/mode/tex/tex.js\":{\"text\":\"!function(t){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?t(require(\\\"../../lib/codemirror\\\")):\\\"function\\\"==typeof define&&define.amd?define([\\\"../../lib/codemirror\\\"],t):t(CodeMirror)}(function(t){\\\"use strict\\\";t.defineMode(\\\"tex\\\",function(t,e){function i(t,e){t.cmdState.push(e)}function a(t){return 0<t.cmdState.length?t.cmdState[t.cmdState.length-1]:null}function n(t,e,n){return function(){this.name=t,this.bracketNo=0,this.style=e,this.styles=n,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,\\\"bracket\\\"},this.closeBracket=function(){}}}var c={};function o(t,e){t.f=e}function u(t,e){if(t.match(/^\\\\\\\\[a-zA-Z@]+/)){var n,r=t.current().slice(1);return i(e,n=new(n=c.hasOwnProperty(r)?c[r]:c.DEFAULT)),o(e,m),n.style}if(t.match(/^\\\\\\\\[$&%#{}_]/))return\\\"tag\\\";if(t.match(/^\\\\\\\\[,;!\\\\/\\\\\\\\]/))return\\\"tag\\\";if(t.match(\\\"\\\\\\\\[\\\"))return o(e,function(t,e){return f(t,e,\\\"\\\\\\\\]\\\")}),\\\"keyword\\\";if(t.match(\\\"\\\\\\\\(\\\"))return o(e,function(t,e){return f(t,e,\\\"\\\\\\\\)\\\")}),\\\"keyword\\\";if(t.match(\\\"$$\\\"))return o(e,function(t,e){return f(t,e,\\\"$$\\\")}),\\\"keyword\\\";if(t.match(\\\"$\\\"))return o(e,function(t,e){return f(t,e,\\\"$\\\")}),\\\"keyword\\\";r=t.next();return\\\"%\\\"==r?(t.skipToEnd(),\\\"comment\\\"):\\\"}\\\"==r||\\\"]\\\"==r?(n=a(e))?(n.closeBracket(r),o(e,m),\\\"bracket\\\"):\\\"error\\\":\\\"{\\\"==r||\\\"[\\\"==r?(i(e,n=new(n=c.DEFAULT)),\\\"bracket\\\"):/\\\\d/.test(r)?(t.eatWhile(/[\\\\w.%]/),\\\"atom\\\"):(t.eatWhile(/[\\\\w\\\\-_]/),\\\"begin\\\"==(n=function(t){for(var e=t.cmdState,n=e.length-1;0<=n;n--){var r=e[n];if(\\\"DEFAULT\\\"!=r.name)return r}return{styleIdentifier:function(){return null}}}(e)).name&&(n.argument=t.current()),n.styleIdentifier())}function f(t,e,n){if(t.eatSpace())return null;if(n&&t.match(n))return o(e,u),\\\"keyword\\\";if(t.match(/^\\\\\\\\[a-zA-Z@]+/))return\\\"tag\\\";if(t.match(/^[a-zA-Z]+/))return\\\"variable-2\\\";if(t.match(/^\\\\\\\\[$&%#{}_]/))return\\\"tag\\\";if(t.match(/^\\\\\\\\[,;!\\\\/]/))return\\\"tag\\\";if(t.match(/^[\\\\^_&]/))return\\\"tag\\\";if(t.match(/^[+\\\\-<>|=,\\\\/@!*:;'\\\"`~#?]/))return null;if(t.match(/^(\\\\d+\\\\.\\\\d*|\\\\d*\\\\.\\\\d+|\\\\d+)/))return\\\"number\\\";var r=t.next();return\\\"{\\\"==r||\\\"}\\\"==r||\\\"[\\\"==r||\\\"]\\\"==r||\\\"(\\\"==r||\\\")\\\"==r?\\\"bracket\\\":\\\"%\\\"==r?(t.skipToEnd(),\\\"comment\\\"):\\\"error\\\"}function m(t,e){var n=t.peek();return\\\"{\\\"==n||\\\"[\\\"==n?(a(e).openBracket(n),t.eat(n),o(e,u),\\\"bracket\\\"):/[ \\\\t\\\\r]/.test(n)?(t.eat(n),null):(o(e,u),(n=e.cmdState.pop())&&n.closeBracket(),u(t,e))}return c.importmodule=n(\\\"importmodule\\\",\\\"tag\\\",[\\\"string\\\",\\\"builtin\\\"]),c.documentclass=n(\\\"documentclass\\\",\\\"tag\\\",[\\\"\\\",\\\"atom\\\"]),c.usepackage=n(\\\"usepackage\\\",\\\"tag\\\",[\\\"atom\\\"]),c.begin=n(\\\"begin\\\",\\\"tag\\\",[\\\"atom\\\"]),c.end=n(\\\"end\\\",\\\"tag\\\",[\\\"atom\\\"]),c.label=n(\\\"label\\\",\\\"tag\\\",[\\\"atom\\\"]),c.ref=n(\\\"ref\\\",\\\"tag\\\",[\\\"atom\\\"]),c.eqref=n(\\\"eqref\\\",\\\"tag\\\",[\\\"atom\\\"]),c.cite=n(\\\"cite\\\",\\\"tag\\\",[\\\"atom\\\"]),c.bibitem=n(\\\"bibitem\\\",\\\"tag\\\",[\\\"atom\\\"]),c.Bibitem=n(\\\"Bibitem\\\",\\\"tag\\\",[\\\"atom\\\"]),c.RBibitem=n(\\\"RBibitem\\\",\\\"tag\\\",[\\\"atom\\\"]),c.DEFAULT=function(){this.name=\\\"DEFAULT\\\",this.style=\\\"tag\\\",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:e.inMathMode?function(t,e){return f(t,e)}:u}},copyState:function(t){return{cmdState:t.cmdState.slice(),f:t.f}},token:function(t,e){return e.f(t,e)},blankLine:function(t){t.f=u,t.cmdState.length=0},lineComment:\\\"%\\\"}}),t.defineMIME(\\\"text/x-stex\\\",\\\"tex\\\"),t.defineMIME(\\\"text/x-latex\\\",\\\"tex\\\")});\",\"type\":\"application/javascript\",\"title\":\"$:/plugins/tiddlywiki/codemirror/mode/tex/tex.js\",\"module-type\":\"codemirror\"},\"$:/plugins/Gk0Wk/codemirror-mode-tiddlywiki5/readme\":{\"text\":\"View more on [[GitHub Repo|https://github.com/Gk0Wk/CodeMirror-Mode-TiddlyWiki5]].\\n\\nAdds Syntax Highlighting for TiddlyWiki5 tiddlers (`text/vnd.tiddlywiki`) to the CodeMirror, along with some other useful editor addon (wikilink hint, macro hint, etc.). Now is under development.\\n\\n为TiddlyWiki的CodeMirror编辑器添加TiddlyWiki5(`text/vnd.tiddlywiki`)语法高亮，同时还有其他有用的编辑器插件(如Wiki链接自动提示、宏提示等)。现在正在开发中。\\n\",\"title\":\"$:/plugins/Gk0Wk/codemirror-mode-tiddlywiki5/readme\"},\"$:/plugins/tiddlywiki/codemirror/addon/hint/hint-tiddlywiki5.js\":{\"text\":\"!function(e){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?e(require(\\\"../../lib/codemirror\\\")):\\\"function\\\"==typeof define&&define.amd?define([\\\"../../lib/codemirror\\\"],e):e(CodeMirror)}(function(c){\\\"use strict\\\";var t={completeSingle:!1};c.defineInitHook(function(e){e.on(\\\"change\\\",function(e,i){if(!(e.state.completeActive&&\\\"function\\\"!=typeof e.showHint||\\\"+input\\\"===i.origin&&\\\"\\\"===i.text[0].trim()&&\\\"\\\"===i.text[1])){if(\\\"+delete\\\"===i.origin){if(\\\"\\\"===i.removed[0])return;if(i.to.ch<2)return;if(\\\"\\\"===e.getDoc().getLine(i.to.line).substr(0,i.to.ch-1).trim())return}e.showHint(t)}})}),c.registerHelper(\\\"hint\\\",\\\"tiddlywiki5\\\",function(e){for(var i=e.getCursor(),t=e.getLine(i.line),r=i.ch,n=i.ch,o=[\\\".\\\",\\\"]\\\",\\\"}\\\",\\\">\\\"],l=[\\\"[\\\",\\\"{\\\",\\\"|\\\",'\\\"'];r;){var s=t.charAt(r-1);if(30<n-r||o.includes(s))return null;if(l.includes(s))break;r--}if(0==r)return null;var f=r!==n&&t.slice(r,n);return\\\"$\\\"==t.charAt(r)?{list:$tw.wiki.filterTiddlers(`[all[tiddlers]search:title:literal[${f}]!prefix[$:/state]]`),from:c.Pos(i.line,r),to:c.Pos(i.line,n)}:{list:$tw.wiki.filterTiddlers(`[all[tiddlers]!is[system]!is[shadow]search:title:literal[${f}]!prefix[$:/state]]`),from:c.Pos(i.line,r),to:c.Pos(i.line,n)}})});\",\"type\":\"application/javascript\",\"title\":\"$:/plugins/tiddlywiki/codemirror/addon/hint/hint-tiddlywiki5.js\",\"module-type\":\"codemirror\"},\"$:/plugins/tiddlywiki/codemirror/addon/other/clickable-link.js\":{\"text\":\"!function(e){\\\"object\\\"==typeof exports&&\\\"object\\\"==typeof module?e(require(\\\"../../lib/codemirror\\\")):\\\"function\\\"==typeof define&&define.amd?define([\\\"../../lib/codemirror\\\"],e):e(CodeMirror)}(function(e){\\\"use strict\\\";var n=/macintosh|mac os x/i.test(navigator.userAgent)?\\\"metaKey\\\":\\\"ctrlKey\\\";e.defineInitHook(function(e){e.on(\\\"mousedown\\\",function(e,t){t[n]&&(t.target.classList.contains(\\\"cm-externallink\\\")?window.open(t.target.innerText):t.target.classList.contains(\\\"cm-internallink\\\")&&(new $tw.Story).navigateTiddler(t.target.innerText))})})});\",\"type\":\"application/javascript\",\"title\":\"$:/plugins/tiddlywiki/codemirror/addon/other/clickable-link.js\",\"module-type\":\"codemirror\"}}}"}